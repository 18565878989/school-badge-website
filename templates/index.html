{% extends "base.html" %}

{% block title %}æ ¡å¾½ç½‘ - {{ _('hero_title') }}{% endblock %}

{% block content %}
<div class="hero">
    <h1>{{ _('hero_title') }}</h1>
    <p>{{ _('hero_subtitle') }}</p>
    
    <form class="search-form" action="{{ url_for('index') }}" method="GET">
        <input type="text" name="q" placeholder="{{ _('search_placeholder') }}" 
               value="{{ search_query }}">
        {% if selected_region %}
        <input type="hidden" name="region" value="{{ selected_region }}">
        {% endif %}
        {% if selected_country %}
        <input type="hidden" name="country" value="{{ selected_country }}">
        {% endif %}
        {% if selected_city %}
        <input type="hidden" name="city" value="{{ selected_city }}">
        {% endif %}
        {% if selected_district %}
        <input type="hidden" name="district" value="{{ selected_district }}">
        {% endif %}
        {% if selected_level %}
        <input type="hidden" name="level" value="{{ selected_level }}">
        {% endif %}
        <button type="submit" style="display:none;">Search</button>
    </form>
</div>

<div class="filters">
    <div class="filter-group">
        <select onchange="window.location.href=this.value">
            <option value="{{ url_for('index') }}" {% if not selected_region %}selected{% endif %}>{{ _('all_regions') }}</option>
            {% for region in regions %}
                <option value="{{ url_for('index', region=region) }}" 
                        {% if selected_region == region %}selected{% endif %}>
                    {{ region }}
                </option>
            {% endfor %}
        </select>
    </div>
    
    {% if countries %}
    <div class="filter-group">
        <select onchange="window.location.href=this.value">
            <option value="{{ url_for('index', region=selected_region) }}" {% if not selected_country %}selected{% endif %}>{{ _('all_countries') }}</option>
            {% for country in countries %}
                <option value="{{ url_for('index', region=selected_region, country=country) }}" 
                        {% if selected_country == country %}selected{% endif %}>
                    {{ country }}
                </option>
            {% endfor %}
        </select>
    </div>
    {% endif %}
    
    {% if cities and not hk_districts %}
    <div class="filter-group">
        <select onchange="window.location.href=this.value">
            <option value="{{ url_for('index', region=selected_region, country=selected_country) }}" {% if not selected_city %}selected{% endif %}>{{ _('all_cities') }}</option>
            {% for city in cities %}
                <option value="{{ url_for('index', region=selected_region, country=selected_country, city=city) }}" 
                        {% if selected_city == city %}selected{% endif %}>
                    {{ city }}
                </option>
            {% endfor %}
        </select>
    </div>
    {% endif %}
    
    {% if hk_districts %}
    <div class="filter-group">
        <select onchange="window.location.href=this.value">
            <option value="{{ url_for('index', region=selected_region, country=selected_country) }}" {% if not selected_district %}selected{% endif %}>{{ _('all_districts') }}</option>
            {% for district in hk_districts %}
                <option value="{{ url_for('index', region=selected_region, country=selected_country, district=district) }}" 
                        {% if selected_district == district %}selected{% endif %}>
                    {{ district }}
                </option>
            {% endfor %}
        </select>
    </div>
    {% endif %}
    
    <div class="filter-group">
        <select onchange="window.location.href=this.value">
            {% if selected_country %}
            <option value="{{ url_for('index', region=selected_region, country=selected_country) }}" {% if not selected_level %}selected{% endif %}>{{ _('all_types') }}</option>
            <option value="{{ url_for('index', region=selected_region, country=selected_country, level='university') }}" {% if selected_level == 'university' %}selected{% endif %}>{{ _('university') }}</option>
            <option value="{{ url_for('index', region=selected_region, country=selected_country, level='middle') }}" {% if selected_level == 'middle' %}selected{% endif %}>{{ _('middle_school') }}</option>
            <option value="{{ url_for('index', region=selected_region, country=selected_country, level='elementary') }}" {% if selected_level == 'elementary' %}selected{% endif %}>{{ _('elementary_school') }}</option>
            <option value="{{ url_for('index', region=selected_region, country=selected_country, level='kindergarten') }}" {% if selected_level == 'kindergarten' %}selected{% endif %}>{{ _('kindergarten') }}</option>
            {% else %}
            <option value="{{ url_for('index', region=selected_region) }}" {% if not selected_level %}selected{% endif %}>{{ _('all_types') }}</option>
            <option value="{{ url_for('index', region=selected_region, level='university') }}" {% if selected_level == 'university' %}selected{% endif %}>{{ _('university') }}</option>
            <option value="{{ url_for('index', region=selected_region, level='middle') }}" {% if selected_level == 'middle' %}selected{% endif %}>{{ _('middle_school') }}</option>
            <option value="{{ url_for('index', region=selected_region, level='elementary') }}" {% if selected_level == 'elementary' %}selected{% endif %}>{{ _('elementary_school') }}</option>
            <option value="{{ url_for('index', region=selected_region, level='kindergarten') }}" {% if selected_level == 'kindergarten' %}selected{% endif %}>{{ _('kindergarten') }}</option>
            {% endif %}
        </select>
    </div>
    
    {% if selected_region or selected_country or selected_city or selected_district or selected_level or search_query %}
        <a href="{{ url_for('index') }}" class="clear-filters">{{ _('clear_filters') }}</a>
    {% endif %}
</div>

{% if total_schools > 0 %}
<div class="stats">
    {{ _('schools_count').format(total_schools) }}
    {% if selected_region or selected_country or selected_city or selected_district or selected_level or search_query %}
        <span class="filter-info">
            {% if selected_region %}Â· {{ selected_region }}{% endif %}
            {% if selected_country %}Â· {{ selected_country }}{% endif %}
            {% if selected_city %}Â· {{ selected_city }}{% endif %}
            {% if selected_district %}Â· {{ selected_district }}{% endif %}
            {% if selected_level %}Â· {{ _(selected_level) }}{% endif %}
            {% if search_query %}Â· "{{ search_query }}"{% endif %}
        </span>
    {% endif %}
</div>
{% endif %}

<div class="schools-grid">
    {% for school in schools %}
        <a href="{{ url_for('school_detail', school_id=school.id) }}" class="school-card">
            <div class="badge-container">
                {% if school.badge_url %}
                    <img src="{{ school.badge_url }}" alt="{{ school.name }} badge" class="badge-image">
                {% else %}
                    <div class="badge-placeholder">ğŸ“</div>
                {% endif %}
            </div>
            <div class="school-info">
                <h3>{{ school.name }}</h3>
                {% if school.name_cn %}
                    <p class="motto">{{ school.name_cn }}</p>
                {% endif %}
                {% if school.motto %}
                    <p class="motto">"{{ school.motto }}"</p>
                {% endif %}
                <p class="location">{{ school.city }}, {{ school.country }}</p>
                <span class="level-badge level-{{ school.level }}">
                    {% if school.level == 'university' %}{{ _('university') }}
                    {% elif school.level == 'middle' %}{{ _('middle_school') }}
                    {% elif school.level == 'elementary' %}{{ _('elementary_school') }}
                    {% else %}{{ _('kindergarten') }}{% endif %}
                </span>
                {% set country_flags = {
                    'China': 'ğŸ‡¨ğŸ‡³',
                    'Hong Kong': 'ğŸ‡­ğŸ‡°',
                    'United Kingdom': 'ğŸ‡¬ğŸ‡§',
                    'United States': 'ğŸ‡ºğŸ‡¸',
                    'Canada': 'ğŸ‡¨ğŸ‡¦',
                    'Australia': 'ğŸ‡¦ğŸ‡º',
                    'Japan': 'ğŸ‡¯ğŸ‡µ',
                    'South Korea': 'ğŸ‡°ğŸ‡·',
                    'Singapore': 'ğŸ‡¸ğŸ‡¬',
                    'Malaysia': 'ğŸ‡²ğŸ‡¾',
                    'Germany': 'ğŸ‡©ğŸ‡ª',
                    'France': 'ğŸ‡«ğŸ‡·',
                    'Italy': 'ğŸ‡®ğŸ‡¹',
                    'Spain': 'ğŸ‡ªğŸ‡¸',
                    'Netherlands': 'ğŸ‡³ğŸ‡±',
                    'Switzerland': 'ğŸ‡¨ğŸ‡­',
                    'Sweden': 'ğŸ‡¸ğŸ‡ª',
                    'Belgium': 'ğŸ‡§ğŸ‡ª',
                    'Austria': 'ğŸ‡¦ğŸ‡¹',
                    'Denmark': 'ğŸ‡©ğŸ‡°',
                    'Finland': 'ğŸ‡«ğŸ‡®',
                    'Norway': 'ğŸ‡³ğŸ‡´',
                    'Ireland': 'ğŸ‡®ğŸ‡ª',
                    'Poland': 'ğŸ‡µğŸ‡±',
                    'Russia': 'ğŸ‡·ğŸ‡º',
                    'Ukraine': 'ğŸ‡ºğŸ‡¦',
                    'Czech Republic': 'ğŸ‡¨ğŸ‡¿',
                    'Hungary': 'ğŸ‡­ğŸ‡º',
                    'Greece': 'ğŸ‡¬ğŸ‡·',
                    'Portugal': 'ğŸ‡µğŸ‡¹',
                    'New Zealand': 'ğŸ‡³ğŸ‡¿',
                    'Taiwan': 'ğŸ‡¹ğŸ‡¼',
                    'India': 'ğŸ‡®ğŸ‡³',
                    'Pakistan': 'ğŸ‡µğŸ‡°',
                    'Bangladesh': 'ğŸ‡§ğŸ‡©',
                    'Sri Lanka': 'ğŸ‡±ğŸ‡°',
                    'Nepal': 'ğŸ‡³ğŸ‡µ',
                    'Thailand': 'ğŸ‡¹ğŸ‡­',
                    'Vietnam': 'ğŸ‡»ğŸ‡³',
                    'Indonesia': 'ğŸ‡®ğŸ‡©',
                    'Philippines': 'ğŸ‡µğŸ‡­',
                    'Cambodia': 'ğŸ‡°ğŸ‡­',
                    'Myanmar': 'ğŸ‡²ğŸ‡²',
                    'Laos': 'ğŸ‡±ğŸ‡¦',
                    'Brunei': 'ğŸ‡§ğŸ‡³',
                    'Timor-Leste': 'ğŸ‡¹ğŸ‡±',
                    'Mongolia': 'ğŸ‡²ğŸ‡³',
                    'Kazakhstan': 'ğŸ‡°ğŸ‡¿',
                    'Uzbekistan': 'ğŸ‡ºğŸ‡¿',
                    'Kyrgyzstan': 'ğŸ‡°ğŸ‡¬',
                    'Tajikistan': 'ğŸ‡¹ğŸ‡¯',
                    'Turkmenistan': 'ğŸ‡¹ğŸ‡²',
                    'Georgia': 'ğŸ‡¬ğŸ‡ª',
                    'Armenia': 'ğŸ‡¦ğŸ‡²',
                    'Azerbaijan': 'ğŸ‡¦ğŸ‡¿',
                    'Turkey': 'ğŸ‡¹ğŸ‡·',
                    'Israel': 'ğŸ‡®ğŸ‡±',
                    'Saudi Arabia': 'ğŸ‡¸ğŸ‡¦',
                    'United Arab Emirates': 'ğŸ‡¦ğŸ‡ª',
                    'Qatar': 'ğŸ‡¶ğŸ‡¦',
                    'Kuwait': 'ğŸ‡°ğŸ‡¼',
                    'Bahrain': 'ğŸ‡§ğŸ‡­',
                    'Oman': 'ğŸ‡´ğŸ‡²',
                    'Jordan': 'ğŸ‡¯ğŸ‡´',
                    'Lebanon': 'ğŸ‡±ğŸ‡§',
                    'Egypt': 'ğŸ‡ªğŸ‡¬',
                    'Morocco': 'ğŸ‡²ğŸ‡¦',
                    'South Africa': 'ğŸ‡¿ğŸ‡¦',
                    'Nigeria': 'ğŸ‡³ğŸ‡¬',
                    'Kenya': 'ğŸ‡°ğŸ‡ª',
                    'Ghana': 'ğŸ‡¬ğŸ‡­',
                    'Ethiopia': 'ğŸ‡ªğŸ‡¹',
                    'Brazil': 'ğŸ‡§ğŸ‡·',
                    'Argentina': 'ğŸ‡¦ğŸ‡·',
                    'Chile': 'ğŸ‡¨ğŸ‡±',
                    'Colombia': 'ğŸ‡¨ğŸ‡´',
                    'Peru': 'ğŸ‡µğŸ‡ª',
                    'Venezuela': 'ğŸ‡»ğŸ‡ª',
                    'Mexico': 'ğŸ‡²ğŸ‡½',
                    'Iceland': 'ğŸ‡®ğŸ‡¸',
                    'Luxembourg': 'ğŸ‡±ğŸ‡º',
                    'Monaco': 'ğŸ‡²ğŸ‡¨',
                    'San Marino': 'ğŸ‡¸ğŸ‡²',
                    'Vatican City': 'ğŸ‡»ğŸ‡¦',
                    'Andorra': 'ğŸ‡¦ğŸ‡©',
                    'Liechtenstein': 'ğŸ‡±ğŸ‡®',
                    'Estonia': 'ğŸ‡ªğŸ‡ª',
                    'Latvia': 'ğŸ‡±ğŸ‡»',
                    'Lithuania': 'ğŸ‡±ğŸ‡¹',
                    'Croatia': 'ğŸ‡­ğŸ‡·',
                    'Slovenia': 'ğŸ‡¸ğŸ‡®',
                    'Serbia': 'ğŸ‡·ğŸ‡¸',
                    'Bulgaria': 'ğŸ‡§ğŸ‡¬',
                    'Romania': 'ğŸ‡·ğŸ‡´',
                    'Belarus': 'ğŸ‡§ğŸ‡¾',
                    'Slovakia': 'ğŸ‡¸ğŸ‡°',
                    'North Macedonia': 'ğŸ‡²ğŸ‡°',
                    'Albania': 'ğŸ‡¦ğŸ‡±',
                    'Bosnia and Herzegovina': 'ğŸ‡§ğŸ‡¦',
                    'Montenegro': 'ğŸ‡²ğŸ‡ª',
                    'Malta': 'ğŸ‡²ğŸ‡¹',
                    'Cyprus': 'ğŸ‡¨ğŸ‡¾',
                    'Fiji': 'ğŸ‡«ğŸ‡¯',
                    'Papua New Guinea': 'ğŸ‡µğŸ‡¬',
                    'Tanzania': 'ğŸ‡¹ğŸ‡¿',
                    'Uganda': 'ğŸ‡ºğŸ‡¬',
                    'Zimbabwe': 'ğŸ‡¿ğŸ‡¼',
                    'Botswana': 'ğŸ‡§ğŸ‡¼',
                    'Namibia': 'ğŸ‡³ğŸ‡¦',
                    'Mauritius': 'ğŸ‡²ğŸ‡º',
                    'Senegal': 'ğŸ‡¸ğŸ‡³',
                    'Ivory Coast': 'ğŸ‡¨ğŸ‡®',
                    'Cameroon': 'ğŸ‡¨ğŸ‡²',
                    'Gabon': 'ğŸ‡¬ğŸ‡¦',
                    'Congo': 'ğŸ‡¨ğŸ‡¬',
                    'Madagascar': 'ğŸ‡²ğŸ‡¬',
                    'Rwanda': 'ğŸ‡·ğŸ‡¼',
                    'Zambia': 'ğŸ‡¿ğŸ‡²',
                    'Sudan': 'ğŸ‡¸ğŸ‡©',
                    'Algeria': 'ğŸ‡©ğŸ‡¿',
                    'Tunisia': 'ğŸ‡¹ğŸ‡³',
                    'Libya': 'ğŸ‡±ğŸ‡¾',
                    'Iraq': 'ğŸ‡®ğŸ‡¶',
                    'Iran': 'ğŸ‡®ğŸ‡·',
                    'Afghanistan': 'ğŸ‡¦ğŸ‡«',
                    'Bangladesh': 'ğŸ‡§ğŸ‡©'
                } %}
                <span class="country-flag" title="{{ school.country }}">
                    {{ country_flags.get(school.country, 'ğŸ³') }}
                </span>
            </div>
        </a>
    {% else %}
        <div class="no-results">
            <p>{{ _('no_schools') }}</p>
            <a href="{{ url_for('index') }}" class="btn btn-primary">{{ _('view_all') }}</a>
        </div>
    {% endfor %}
</div>

{% if total_pages > 1 %}
<div class="pagination">
    {% if page > 1 %}
        <a href="{{ url_for('index', page=page-1, region=selected_region, country=selected_country, district=selected_district, level=selected_level, q=search_query) }}" class="page-btn">â€¹ {{ _('prev') }}</a>
    {% endif %}
    
    {% for p in range(1, total_pages + 1) %}
        {% if p == page %}
            <span class="page-current">{{ p }}</span>
        {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
            <a href="{{ url_for('index', page=p, region=selected_region, country=selected_country, city=selected_city, district=selected_district, level=selected_level, q=search_query) }}" class="page-num">{{ p }}</a>
        {% elif p == page - 3 or p == page + 3 %}
            <span class="page-ellipsis">...</span>
        {% endif %}
    {% endfor %}
    
    {% if page < total_pages %}
        <a href="{{ url_for('index', page=page+1, region=selected_region, country=selected_country, city=selected_city, district=selected_district, level=selected_level, q=search_query) }}" class="page-btn">{{ _('next') }} â€º</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}
